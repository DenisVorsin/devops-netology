3.7. Компьютерные сети, лекция 2

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?


        в Linux можно использовать ip link или ifconfig. в Windows - ipconfig или Get-NetAdapter (powershell)

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого? 


        Для распознавания пакета используется протокол lldp, пакет называется lldpd, приложение lldpcli
        команда lldpcli show neighbors

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.


        Технология называется 802.1q (vlan). пакет "vlan".

Через команды можно настроить следующим образом:
```shell
sudo modprobe 8021q
sudo ip link add link eth1 name eth1.10 type vlan id 10
sudo ip addr add 10.0.0.1/24 dev eth1.10
sudo ip link set up eth1.10
```

либо через конфигурационный файл `/etc/network/interfaces`
```shell
auto eth1.10
iface eth1.10 inet static
    address 10.0.0.1
    netmask 255.255.255.0
    vlan-raw-device eth1
```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига. 


        Агрегация может быть статическая или динамическая (с помощью протокола LACP).

Пример настройки статической агрегацией
```shell
auto eth0
iface eth0 inet manual
    bond-master bond0
    bond-primary eth0

auto eth1
iface eth1 inet manual
    bond-master bond0

auto bond0
iface bond0 inet static
    address 192.168.1.10
    gateway 192.168.1.1
    netmask 255.255.255.0
    bond-mode active-backup
    bond-miimon 100
    bond-slaves none
```

Пример настройки с динамической агрегацией
```shell
auto eth0
iface eth0 inet manual
    bond-master bond0

auto eth1
iface eth1 inet manual
    bond-master bond0

auto bond0
iface bond0 inet static
    address 192.168.1.10
    gateway 192.168.1.1
    netmask 255.255.255.0

    # Настройки протокола LACP
    bond-mode 4
    bond-miimon 100
    bond-lacp-rate 1
    bond-slaves eth0 eth1
```

Режимы работы `bond-mode`:
 - balance-rr (0) - отправка пакетов между интерфейсам по очереди (обеспечивается балансировка нагрузки и отказоустойчивость)
 - active-backup (1) - активен только 1 интерфейс, второй подключается в случае ошибки первого.
 - balance-xor (2) - порт выбирается на основе настраиваемого алгоритма хеширпования, по умолчанию для хеша используется mac отправителя + mac получателя
 - broadcast (3) - все пакеты рассылаются по всем портам (используется для отказоустойчивости)
 - 802.3ad (4) - включает протокол LACP, требуется поддержка со стороны коммутатора.
 - balance-tlb (5) - адаптивная балансировка нагрузки, балансирует исходящий трафик, входящий принимается как есть.
 - balance-alb (6) - адаптивная балансировка нагрузки, так же как balance-tlb но с возможностью балансировки входящего трафик.



6. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24. 

 - в сети с маской /29 8 IP-адресов, 1 - адрес сети, 6 адресов хостов, 1 - широковещательный адрес. 
 - из сети /24 можно получить 32 сети с маской /29
 - примеры сетей: 10.10.10.0/29, 10.10.10.8/29, 10.10.10.32/29


7. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.


        В качестве приватных адресов можно взять еще адрес из 100.64.0.0/10, например 100.100.100.0/26 (100.100.100.1 - 100.100.100.62)

8. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

 - для проверки ARP таблици и в Linux и в Windows можно использовать `arp -a`
 - для очистки arp cache в Linux можно импользовать `ip -s -s neigh flush all`. Для очистки arp cache в Windows можно использовать `arp -d`.
 - для удаления адреса хоста и в Linux и в Windows можно использовать `arp -d <IP>`


